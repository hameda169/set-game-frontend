(window.webpackJsonpset_game_frontend=window.webpackJsonpset_game_frontend||[]).push([[0],{44:function(e,t,a){e.exports=a(63)},49:function(e,t,a){},51:function(e,t,a){},63:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(36),s=a.n(o),r=(a(49),a(38)),l=a(2),i=(a(50),a(51),a(3)),m=a(4),d=a(5),u=a(6),h=a(19),f=a(42),g=a(41),E=a(30),v=a(65),p=a(64),N="https://set-api.hameda169.ir",k=["shape","color","num","fill","onClick","active","width","height"];function _(e){var t=e.shape,a=e.color,n=e.num,o=e.fill,s=e.onClick,r=e.active,l=e.width,i=e.height,m=Object(f.a)(e,k),d="".concat(t).concat(a).concat(n).concat(o);o=0===o?"00":1===o?"45":"cc",a=0===a?"#ff0000":1===a?"#00aa00":"#0000ff",n+=1;var u=function(e){return c.a.createElement("div",null,0===t&&c.a.createElement(E.Triangle,e),1===t&&c.a.createElement(E.Rectangle,e),2===t&&c.a.createElement(E.Ellipse,Object.assign({},e,{rx:e.width/2,ry:e.height/2})))};return c.a.createElement("div",Object.assign({},m,{className:"game-cards ".concat(r?"active":""),onClick:function(){return s(d)},style:{width:l?30:null,height:i?50:null}}),Object(h.a)(Array(n)).map((function(e,t){return c.a.createElement(u,{key:"".concat(t),width:l||90,height:i||50,fill:{color:"".concat(a).concat(o)},stroke:{color:a},strokeWidth:i?i/10:5})})),r&&c.a.createElement("div",{className:"my-badge"},"\u2713"))}var b=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).message_received=function(e){console.log(e)},n._join=function(){n.state.name.length<2?alert("Please Enter Your Name"):n.state.isJoined?console.log("You Are joined the room"):n.socket.emit("join",{name:n.state.name,room:"".concat(n.roomId)})},n._start=function(){n.state.isStarted?console.log("Game is started"):n.socket.emit("start_room",{id:n.roomId})},n._deal=function(){n.socket.emit("deal",{room:n.roomId})},n._challenge=function(e){n.state.restricted||3!==e.length||n.socket.emit("challenge",{cards:e,room:n.roomId}),n.state.restricted&&(n.setState({selected:[]}),console.log("You are restricted"))},n._cardClicked=function(e){n.state.selected.includes(e)?n.setState({selected:Object(h.a)(n.state.selected.filter((function(t){return t!==e})))}):n.state.cards.includes(e)&&n.setState({selected:[].concat(Object(h.a)(n.state.selected),[e])},(function(){return n._challenge(n.state.selected)}))},n._joinResult=function(e,t){console.log("Join",e,t),0===e&&(n.setState({userPublicId:t.id,userSid:t.sid,isJoined:!0,roomName:t.room_name}),console.log("You joined room successfully"))},n._initGame=function(e){console.log("Init",e),n.setState({cards:e.cards,isStarted:!0})},n._challengeResponse=function(e,t){console.log("Challenge",e,t),n.setState({selected:[]}),0===e?(n.setState({cards:Object(h.a)(n.state.cards).filter((function(e){return!t.cards.includes(e)})),restricted:!1}),n.setState({users:t.users})):t.id===n.state.userPublicId?n.setState({restricted:!0}):n.setState({restricted:!1})},n._dealResponse=function(e,t){0===e&&n.setState({cards:[].concat(Object(h.a)(n.state.cards),Object(h.a)(t.cards))})},n._initSocket=function(){n.socket=Object(g.a)(n.state.endpoint),n.socket.on("message",n.message_received),n.socket.on("join_success",(function(e){return n._joinResult(0,e)})),n.socket.on("init",n._initGame),n.socket.on("challenge_success",(function(e){return n._challengeResponse(0,e)})),n.socket.on("challenge_fail",(function(e){return n._challengeResponse(1,e)})),n.socket.on("deal_success",(function(e){return n._dealResponse(0,e)})),n.socket.on("deal_fail",(function(e){return n._dealResponse(1,e)}))},n.nameChanged=function(e){n.setState({name:e.target.value})},n.socket=null,n.roomId=e.match.params.id,n.state={name:"",endpoint:N,roomName:"",cards:[],selected:[],isJoined:!1,isStarted:!1,userPublicId:"",userSid:"",restricted:!1,errorMessage:null,users:{}},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(this.state.endpoint,"/room/").concat(this.roomId)).then((function(e){return e.json()})).then((function(t){console.log(t),t.started?e.setState({errorMessage:"This room is now started"}):e._initSocket()}))}},{key:"render",value:function(){var e,t,a=this;e=parseInt(Math.sqrt(this.state.cards.length)+.9),t=parseInt(Math.sqrt(this.state.cards.length)+.9);var n=Object(h.a)(Array(e)).map((function(e,n){return a.state.cards.slice(n*t,t*(n+1))}));return c.a.createElement("div",{className:"container"},this.state.errorMessage&&c.a.createElement("div",{className:"row error"},this.state.errorMessage),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm-3"},c.a.createElement("div",{className:"col panel"},c.a.createElement("div",null,this.state.isJoined?c.a.createElement("div",{style:{marginTop:20}},c.a.createElement(v.a,{disabled:this.state.isJoined},"Your Name: ",this.state.name)):c.a.createElement("form",{className:"form-horizontal",id:"creating",onSubmit:this._join,style:{display:"flex"}},c.a.createElement("div",{className:"form-group",style:{flex:1}},c.a.createElement("div",null,c.a.createElement("input",{className:"form-control",onChange:this.nameChanged,placeholder:"Enter Name"}))),c.a.createElement("div",{className:"form-group"},c.a.createElement("div",null,c.a.createElement(v.a,{onClick:this._join},"Join Room"))))),this.state.isJoined&&c.a.createElement("div",{style:{marginTop:20}},c.a.createElement(v.a,{disabled:this.state.isJoined},"Room: ",this.state.roomName)),this.state.isJoined&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{marginTop:20}},c.a.createElement(v.a,{disabled:this.state.isStarted,onClick:this._start},this.state.isStarted?"Started":"Start Room")),c.a.createElement("div",{style:{marginTop:20}},c.a.createElement(v.a,{onClick:this._deal},"New Cards")),c.a.createElement("div",{style:{marginTop:20}},Object.values(this.state.users).map((function(e,t){return c.a.createElement(p.a,{key:"".concat(t)},"".concat(t+1,".").concat(e.name,": ").concat(e.scores.length))})))))),c.a.createElement("div",{className:"col-sm-9"},c.a.createElement("div",{style:{textAlign:"center",backgroundColor:"darkseagreen",width:"100%",minHeight:"100vh"}},n.map((function(e,t){return c.a.createElement("div",{key:"".concat(t),className:"cards-row"},e.map((function(e,t){var n=a.state.selected.indexOf(e)>-1;return e=e.split("").map((function(e){return parseInt(e)})),c.a.createElement(_,{key:"".concat(t),shape:e[0],color:e[1],num:e[2],fill:e[3],active:n,onClick:a._cardClicked})})))}))))))}}]),a}(n.Component);var S=function(e){var t=function(t){e.history.push("/game/".concat(t))},a=function(e){if(0===e){var a=document.getElementById("name").value;fetch("".concat(N,"/room"),{method:"POST",body:JSON.stringify({name:a}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e),"createRoom_success"===e.type&&t(e.room.id)}))}if(1===e){var n=document.getElementById("id").value;t(n)}};return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm-6"},c.a.createElement("div",{className:"create"},c.a.createElement("h2",null,"Create Room"),c.a.createElement("form",{className:"form-horizontal",id:"creating",onSubmit:function(){return a(0)}},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"control-label col-sm-2"},"Name:"),c.a.createElement("div",{className:"col-sm-10"},c.a.createElement("input",{className:"form-control",id:"name",placeholder:"Enter Name",name:"name"}))),c.a.createElement("div",{className:"form-group"},c.a.createElement("div",{className:"col-sm-offset-2 col-sm-10"},c.a.createElement(v.a,{onClick:function(){return a(0)}},"Submit")))))),c.a.createElement("div",{className:"col-sm-6"},c.a.createElement("div",{className:"create"},c.a.createElement("h2",null,"Join Room"),c.a.createElement("form",{className:"form-horizontal",id:"joining",onSubmit:function(){return a(1)}},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"control-label col-sm-3"},"Room Id:"),c.a.createElement("div",{className:"col-sm-10"},c.a.createElement("input",{className:"form-control",id:"id",placeholder:"Enter Room Id",name:"id"}))),c.a.createElement("div",{className:"form-group"},c.a.createElement("div",{className:"col-sm-offset-2 col-sm-10"},c.a.createElement(v.a,{onClick:function(){return a(1)}},"Submit"))))))))},y=function(){return c.a.createElement(r.a,null,c.a.createElement(l.c,null,c.a.createElement(l.a,{exact:!0,path:"/",component:S}),c.a.createElement(l.a,{strict:!0,path:"/game/:id",component:b})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[44,1,2]]]);
//# sourceMappingURL=main.58a501ea.chunk.js.map